#include <math.h>
#include <algorithm>
#include <stdio.h>
#include <string.h>
using namespace std;
#define MOD 10007
#define MAXN 1000010
char s[MAXN], t[MAXN];
int n, m, len;
int nex[MAXN], dp[MAXN];
void get_next();
int main() {
	int num;
	while (scanf("%d", &num) != EOF) {
		while (num--) {
			int sum = 0;
			scanf("%d", &m);
			getchar();
			scanf("%s", t);
			get_next();
			dp[0] = 0;
			for (int i = 1;i <= m;i++) {
				dp[i] = dp[nex[i]] + 1;
				sum += dp[i];
				sum %= MOD;
			}
			printf("%d\n", sum);
		}
	}
	return 0;	
} 

void get_next() {
	nex[0] = -1;
	int j = 0,k = -1;
	while (j < m) {
		if (k == -1 || t[j] == t[k]) {
			nex[++j] = ++k;
		} else {
			k = nex[k];
		}
	}
}
